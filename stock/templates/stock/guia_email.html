{% load i18n %}
{% load l10n %}
{% load static %}

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{% blocktrans %}Guia de Transporte {{ guia.numero_guia }}{% endblocktrans %}</title>
</head>
<body style="font-family: Arial, sans-serif; font-size: 12px; line-height: 1.5; background-color: #f4f4f4; margin: 0; padding: 20px;">
    <table width="100%" border="0" cellpadding="0" cellspacing="0">
        <tr>
            <td align="center">
                <table width="600" border="0" cellpadding="0" cellspacing="0" style="background-color: #ffffff; border: 1px solid #dddddd; border-radius: 5px; padding: 30px;">
                    <tr>
                        <td style="padding-bottom: 20px;">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td valign="top">
                                        {% if logo_url %}
                                            {# --- ALTERAÇÃO AQUI: Tamanho do logótipo igual ao do email da fatura --- #}
                                            <img src="{{ logo_url }}" alt="Logotipo" style="max-height: 90px; max-width: 220px; height: auto; width: auto;">
                                        {% elif dados_empresa %}
                                            <h2 style="margin: 0;">{{ dados_empresa.nome_empresa }}</h2>
                                        {% endif %}
                                    </td>
                                    <td valign="top" align="right">
                                        <h1 style="margin: 0; font-size: 24px; color: #333;">{% trans "GUIA DE TRANSPORTE" %}</h1>
                                        <p style="margin: 5px 0 0 0;"><strong>Nº:</strong> {{ guia.numero_guia }}</p>
                                        <p style="margin: 5px 0 0 0;"><strong>{% trans "Data" %}:</strong> {{ guia.data_emissao }}</p>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr><td style="border-bottom: 2px solid #000; padding-top: 10px;"></td></tr>
                    <tr>
                        <td style="padding-top: 20px; padding-bottom: 30px;">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td width="33%" valign="top" style="padding-right: 10px;">
                                        <h4 style="margin: 0 0 5px 0; font-size: 13px;">{% trans "Expedidor" %}</h4>
                                        <strong>{{ dados_empresa.nome_empresa }}</strong><br>
                                        {{ dados_empresa.endereco|linebreaksbr }}<br>
                                        NIF: {{ dados_empresa.nif }}
                                    </td>
                                    <td width="33%" valign="top" style="padding-left: 10px; padding-right: 10px;">
                                        <h4 style="margin: 0 0 5px 0; font-size: 13px;">{% trans "Destinatário" %}</h4>
                                        <strong>{{ guia.cliente.nome }}</strong><br>
                                        {% if guia.cliente.endereco %}{{ guia.cliente.endereco|linebreaksbr }}<br>{% endif %}
                                        {% if guia.cliente.nif %}NIF: {{ guia.cliente.nif }}{% endif %}
                                    </td>
                                    <td width="33%" valign="top" style="padding-left: 10px;">
                                        <h4 style="margin: 0 0 5px 0; font-size: 13px;">{% trans "Transporte" %}</h4>
                                        <strong>{% trans "Matrícula" %}:</strong> {{ guia.matricula_veiculo|default:"N/A" }}<br>
                                        <strong>{% trans "Carga" %}:</strong> {{ guia.morada_carga|linebreaksbr }}<br>
                                        <strong>{% trans "Descarga" %}:</strong> {{ guia.morada_descarga|linebreaksbr }}
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <table width="100%" cellpadding="8" cellspacing="0" style="border-collapse: collapse;">
                                <thead style="background-color: #f2f2f2;">
                                    <tr>
                                        <th style="border: 1px solid #ddd; text-align: left;">{% trans "Produto / Serviço" %}</th>
                                        <th style="border: 1px solid #ddd; text-align: right;">{% trans "Quantidade" %}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in guia.itens.all %}
                                    <tr>
                                        <td style="border: 1px solid #ddd;">{{ item.produto.nome }}{% if item.produto.calibre %} ({{ item.produto.calibre }}){% endif %}</td>
                                        <td style="border: 1px solid #ddd;" align="right">{{ item.quantidade|floatformat:2 }} {{ item.produto.get_unidade_medida_display }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </td>
                    </tr>
                    
                    <tr>
                        <td style="padding-top: 30px; border-top: 1px solid #cccccc; margin-top: 30px;">
                            <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                <tr >
                                    <td align="right" style="text-align: right; font-size: 11px; color: #555;">
                                        {% if dados_empresa.endereco %}
                                            <strong>{{ dados_empresa.nome_empresa }}</strong>
                                            <p style="margin-top: 5px; margin-bottom: 0;">
                                                <strong>{% trans "Endereço" %}:</strong><br>
                                                {{ dados_empresa.endereco|linebreaksbr }}
                                            </p>
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" style="padding-top: 20px; font-size: 10px; color: #888;">
                                        {% trans "Processado por" %}: {{ guia.utilizador.username|default:"N/A" }}
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>